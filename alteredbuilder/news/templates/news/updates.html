{% extends "base.html" %}

{% load static %}
{% load i18n %}


{% block title %}{% translate "News" %}{% endblock %}

{% block head %}
    {{ block.super }}
    <style>
        .news-card { display: none; }

        .video-scroll {
            overflow-x: auto;
        }

        .video-card {
            display: inline-block;
            width: 300px;
            margin-right: 1rem;
            vertical-align: top;
        }

        .video-card img {
            width: 100%;
            height: auto;
            border-top-left-radius: .25rem;
            border-top-right-radius: .25rem;
        }

        .video-title {
            font-size: 1rem;
            font-weight: 500;
            color: #212529;
            text-decoration: none;
        }

        .video-title:hover {
            color: #0d6efd;
        }
    </style>
{% endblock %}

{% block content %}


<h1>Latest Updates</h1>

<h2>Latest News</h2>

<div class="row g-3">
    
    <div class="row g-3" id="newsContainer">
        {% for item in blogs %}
        <div class="col-md-2 news-card">
            <div class="card h-100 shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">
                        <a href="{{ item.link }}" target="_blank" class="text-decoration-none">
                            {{ item.title|truncatewords:10 }}
                        </a>
                    </h5>
                    <p class="card-text small text-muted">
                        {{ item.description|truncatewords:20 }}
                    </p>
                </div>
                <div class="card-footer text-muted small">
                    {{ item.published_at }}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="d-flex justify-content-center mt-3">
        <button id="prevBtn" class="btn btn-outline-primary me-2" disabled>Previous</button>
        <button id="nextBtn" class="btn btn-primary">Next</button>
    </div>
    {% comment %} {% for item in blogs %}
    <div class="col-md-2">
        <div class="card h-100 shadow-sm">
            <div class="card-body">
                <h5 class="card-title">
                    <a href="{{ item.link }}" target="_blank" class="stretched-link text-decoration-none">
                        {{ item.title|truncatewords:10 }}
                    </a>
                </h5>
                <p class="card-text small text-muted">
                    {{ item.description|truncatewords:20 }}
                </p>
            </div>
            <div class="card-footer text-muted small">
                {{ item.published_at|timesince }}
            </div>
        </div>
    </div>
    {% endfor %} {% endcomment %}
</div>

<h2>Latest YouTube Videos</h2>

{% comment %} <div class="container">
    <div class="video-scroll d-flex">
        {% for video in youtube_videos %}
        <div class="card video-card shadow-sm">
            <a href="https://www.youtube.com/watch?v={{ video.video_id }}" target="_blank">
                <img src="{{ video.thumbnail }}" class="card-img-top" alt="{{ video.title }}">
            </a>
            <div class="card-body">
                <a href="https://www.youtube.com/watch?v={{ video.video_id }}" target="_blank" class="video-title d-block">
                    {{ video.title }}
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
</div> {% endcomment %}
<ul>
    {% for video in youtube_videos %}
    <li>
        <a href="https://www.youtube.com/watch?v={{ video.video_id }}" target="_blank">{{ video.title }}</a>
        <small>{{ video.published_at }}</small>
    </li>
    {% endfor %}
</ul>

<h2>Live Twitch Streams</h2>
<ul>
    {% for stream in twitch_streams %}
    <li>
        <a href="https://twitch.tv/{{ stream.user_name }}">{{ stream.title }} - {{ stream.user_name }}</a>
        <small>{{ stream.viewer_count }} viewers</small>
    </li>
    {% endfor %}
</ul>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const cards = document.querySelectorAll(".news-card");
    const perPage = 6;
    let currentPage = 0;

    function showPage(page) {
        // hide all
        cards.forEach(c => c.style.display = "none");

        // show only the group
        const start = page * perPage;
        const end = start + perPage;
        for (let i = start; i < end && i < cards.length; i++) {
            cards[i].style.display = "block";
        }

        // enable/disable buttons
        document.getElementById("prevBtn").disabled = (page === 0);
        document.getElementById("nextBtn").disabled = (end >= cards.length);
    }

    document.getElementById("prevBtn").addEventListener("click", function() {
        if (currentPage > 0) {
            currentPage--;
            showPage(currentPage);
        }
    });

    document.getElementById("nextBtn").addEventListener("click", function() {
        if ((currentPage + 1) * perPage < cards.length) {
            currentPage++;
            showPage(currentPage);
        }
    });

    // init
    showPage(currentPage);
});
</script>
{% endblock %}